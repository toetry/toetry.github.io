---
sidebar_position: 4
---

## 消息

有关消息操作的 API



### 发送私聊消息

终结点：`send_private_msg`

**参数**

| 字段名           | 数据类型    | 默认值     | 说明                                               |
|---------------|---------|---------|----------------------------------------------------------|
| `user_id`     | int64   | -       | 对方 QQ 号                                                |
| `group_id`    | int64   | -       | 主动发起临时会话时的来源群号(可选, 机器人本身必须是管理员/群主)   |
| `message`     | message | -       | 要发送的内容                                               |
| `auto_escape` | boolean | `false` | 消息内容是否作为纯文本发送 ( 即不解析 CQ 码 ) , 只在 `message` 字段是字符串时有效 |

**响应数据**

| 字段名          | 数据类型  | 说明    |
|--------------|-------|-------|
| `message_id` | int32 | 消息 ID |

###  发送群聊消息

终结点：`send_group_msg`

**参数**

| 字段名 | 数据类型 | 默认值 | 说明 |
| ----- | ------- | ----- | --- |
| `group_id` | int64 | - | 群号 |
| `message` | message | - | 要发送的内容 |
| `auto_escape` | boolean | `false` | 消息内容是否作为纯文本发送 ( 即不解析 CQ 码 ) , 只在 `message` 字段是字符串时有效 |

**响应数据**

| 字段名 | 数据类型 | 说明 |
| ----- | ------- | --- |
| `message_id` | int32 | 消息 ID |



### 发送消息

终结点：`send_msg`

**参数**

| 字段名         | 数据类型 | 默认值  | 说明                                                         |
| -------------- | -------- | ------- | ------------------------------------------------------------ |
| `message_type` | string   | -       | 消息类型, 支持 `private`、`group` , 分别对应私聊、群组, 如不传入, 则根据传入的 `*_id` 参数判断 |
| `user_id`      | int64    | -       | 对方 QQ 号 ( 消息类型为 `private` 时需要 )                   |
| `group_id`     | int64    | -       | 群号 ( 消息类型为 `group` 时需要 )                           |
| `message`      | message  | -       | 要发送的内容                                                 |
| `auto_escape`  | boolean  | `false` | 消息内容是否作为纯文本发送 ( 即不解析 CQ 码 ) , 只在 `message` 字段是字符串时有效 |

**响应数据**

| 字段名       | 数据类型 | 说明    |
| ------------ | -------- | ------- |
| `message_id` | int32    | 消息 ID |



### 获取消息

终结点: `get_msg`

**参数**

| 字段         | 类型  | 说明   |
| ------------ | ----- | ------ |
| `message_id` | int32 | 消息id |

**响应数据**

| 字段           | 类型    | 说明                                   |
| -------------- | ------- | -------------------------------------- |
| `group`        | bool    | 是否是群消息                           |
| `group_id`     | int64   | 是群消息时的群号(否则不存在此字段)     |
| `message_id`   | int32   | 消息id                                 |
| `real_id`      | int32   | 消息真实id                             |
| `message_type` | string  | 群消息时为`group`, 私聊消息为`private` |
| `sender`       | object  | 发送者                                 |
| `time`         | int32   | 发送时间                               |
| `message`      | message | 消息内容                               |
| `raw_message`  | message | 原始消息内容                           |

其中`sender`字段包含两个字段:

| 字段       | 类型   | 说明         |
| ---------- | ------ | ------------ |
| `nickname` | string | 发送者昵称   |
| `user_id`  | int64  | 发送者 QQ 号 |

::: warning 注意
在 go-cqhttp-v0.9.35~v0.9.36-fix3 版本中 `raw_message` 字段为 `message_raw`

在 go-cqhttp-v0.9.35以前的版本中不存在 `message_raw` 字段

在 go-cqhttp-v0.9.29-fix1 以前的版本可能不符合该文档
:::



### 撤回消息

终结点：`delete_msg`

**参数**

| 字段名       | 数据类型 | 默认值 | 说明    |
| ------------ | -------- | ------ | ------- |
| `message_id` | int32    | -      | 消息 ID |

::: tip 提示
该 API 无响应数据
:::



### 标记消息已读

终结点: `mark_msg_as_read`

**参数**

| 字段         | 类型  | 说明   |
| ------------ | ----- | ------ |
| `message_id` | int32 | 消息id |

::: tip 提示
该 API 无响应数据
:::


### 获取合并转发内容

终结点: `get_forward_msg`

**参数**

| 字段         | 类型   | 说明   |
| ------------ | ------ | ------ |
| `message_id` | string | 消息id |

::: tip 提示
字段 `message_id` 对应[合并转发](https://docs.go-cqhttp.org/cqcode/#%E5%90%88%E5%B9%B6%E8%BD%AC%E5%8F%91)中的 `id` 字段
:::

**响应数据**

| 字段       | 类型              | 说明     |
| ---------- | ----------------- | -------- |
| `messages` | forward message[] | 消息列表 |

响应示例

````json
{
    "data": {
        "messages": [
            {
                "content": "合并转发1",
                "sender": {
                    "nickname": "发送者A",
                    "user_id": 10086
                },
                "time": 1595694374
            },
            {
                "content": "合并转发2[CQ:image,file=xxxx,url=xxxx]",
                "sender": {
                    "nickname": "发送者B",
                    "user_id": 10087
                },
                "time": 1595694393
            }
        ]
    },
    "retcode": 0,
    "status": "ok"
}
````



### 发送合并转发 ( 群聊 )

终结点: `send_group_forward_msg`

**参数**

| 字段       | 类型           | 说明                                                         |
| ---------- | -------------- | ------------------------------------------------------------ |
| `group_id` | int64          | 群号                                                         |
| `messages` | forward node[] | 自定义转发消息, 具体看 [CQcode](https://docs.go-cqhttp.org/cqcode/#%E5%90%88%E5%B9%B6%E8%BD%AC%E5%8F%91%E6%B6%88%E6%81%AF%E8%8A%82%E7%82%B9) |

**响应数据**

| 字段名       | 数据类型 | 说明        |
| ------------ | -------- | ----------- |
| `message_id` | int64    | 消息 ID     |
| `forward_id` | string   | 转发消息 ID |



### 发送合并转发 ( 好友 )

终结点: `send_private_forward_msg`

**参数**

| 字段       | 类型           | 说明                                                         |
| ---------- | -------------- | ------------------------------------------------------------ |
| `user_id`  | int64          | 好友QQ号                                                     |
| `messages` | forward node[] | 自定义转发消息, 具体看 [CQcode](https://docs.go-cqhttp.org/cqcode/#%E5%90%88%E5%B9%B6%E8%BD%AC%E5%8F%91%E6%B6%88%E6%81%AF%E8%8A%82%E7%82%B9) |

**响应数据**

| 字段名       | 数据类型 | 说明        |
| ------------ | -------- | ----------- |
| `message_id` | int64    | 消息 ID     |
| `forward_id` | string   | 转发消息 ID |



### 获取群消息历史记录

终结点：`get_group_msg_history`

**参数** 

| 字段          | 类型  | 说明                                |
| ------------- | ----- | ----------------------------------- |
| `message_seq` | int64 | 起始消息序号, 可通过 `get_msg` 获得 |
| `group_id`    | int64 | 群号                                |

**响应数据**

| 字段       | 类型      | 说明                       |
| ---------- | --------- | -------------------------- |
| `messages` | Message[] | 从起始序号开始的前19条消息 |

::: tip 提示
不提供起始序号将默认获取最新的消息
:::

